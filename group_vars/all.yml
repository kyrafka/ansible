unix_groups: 
  - name: pcgamers
    state: present
    gid: 3000  # IMPORTANTE: Mismo GID en servidor y VMs para NFS
  - name: servicios
    state: present

users:
  # Usuario gamer01 eliminado - no es necesario en el servidor
  # Los usuarios del servidor se crean en el rol server_users
  
  - name: steam_epic_svc
    state: present
    shell: /usr/sbin/nologin
    groups: [pcgamers]
    primary_group: servicios
    home: /srv/steam_epic_svc
    create_home: true


filesystem_permissions:
  - path: /srv/steam_epic_svc        
    state: directory
    owner: steam_epic_svc
    group: pcgamers
    mode: "2770"                    
    recurse: false
game_servers_dir: /opt/game_servers

# Permisos en Windows para el grupo 'pcgamers'
windows_acl_rules:
  - path: 'C:\\Games'
    user_or_group: 'pcgamers'
    rights: Modify
    type: allow
    inherit: ContainerInherit, ObjectInherit
    propagation: None
    state: present
    ensure_path: true

cron_restart_service: game_updater.service
cron_time: "0 3 * * *"

# winrm
win_admin_user: "gamepc1"
win_admin_password: "{{ vault_win_admin_password }}"
enable_rdp: true

# Usuarios Ubuntu Desktop por rol (SOLO para VMs cliente, NO para el servidor)
ubuntu_desktop_users:
  admin:
    username: "administrador"
    password: "{{ vault_ubuntu_desktop_admin_password }}"
  auditor:
    username: "auditor"
    password: "{{ vault_ubuntu_desktop_auditor_password }}"
  cliente:
    username: "gamer01"
    password: "{{ vault_ubuntu_desktop_cliente_password }}"

# Usuarios Windows 11 por rol (SOLO para VMs cliente, NO para el servidor)
windows11_users:
  admin:
    username: "Administrador"
    password: "{{ vault_windows11_admin_password }}"
  auditor:
    username: "Auditor"
    password: "{{ vault_windows11_auditor_password }}"
  cliente:
    username: "Gamer01"
    password: "{{ vault_windows11_cliente_password }}"

# Configuración de red IPv6
network_config:
  # Red principal
  ipv6_network: "2025:db8:10::/64"
  ipv6_gateway: "2025:db8:10::1"
  dhcp_range_start: "2025:db8:10::100"    
  dhcp_range_end: "2025:db8:10::200"      
  dns_servers: 
    - "2001:4860:4860::8888"              # Google DNS IPv6
    - "2001:4860:4860::8844"
  domain_name: "gamecenter.lan"

# Configuración del servidor DHCPv6
dhcp6_config:
  default_lease_time: 600
  max_lease_time: 7200

# Configuración bertvv.radvd (RA administrado + DHCPv6 stateful)
radvd_interfaces:
  - device: ens34
    AdvSendAdvert: 'on'
    MinRtrAdvInterval: 30
    MaxRtrAdvInterval: 100
    AdvManagedFlag: 'on'
    AdvOtherConfigFlag: 'on'
    prefixes:
      - prefix: fd10:10::/64
        AdvOnLink: 'on'
        AdvAutonomous: 'on'
      - prefix: fd30:30::/64
        AdvOnLink: 'on'
        AdvAutonomous: 'on'

# Variables para debops.radvd (RA administrado + DHCPv6 stateful)
radvd__interfaces:
  - name: "ens34"
    options:
      - AdvSendAdvert: 'on'
      - MinRtrAdvInterval: 30
      - MaxRtrAdvInterval: 100
      - AdvManagedFlag: 'on'
      - AdvOtherConfigFlag: 'on'
    prefixes:
      - prefix: "fd10:10::/64"
        options:
          - AdvOnLink: 'on'
          - AdvAutonomous: 'off'
      - prefix: "fd30:30::/64"
        options:
          - AdvOnLink: 'on'
          - AdvAutonomous: 'off'

# Configuración VirtualBox (PC Local)
virtualbox:
  vm_name: "Win11-GamePC"
  os_type: "Windows11_64"
  memory: 4096

# Configuración VMware vSphere
# Nota: los valores reales se definen en archivos específicos por despliegue
# en  `group_vars/ubpc.yml` ps

servicios_necesarios:
  - ssh                  # Acceso remoto seguro
  - cron                 # Programador de tareas
  - systemd-timesyncd    # Sincronización de hora
  - rsyslog              # Logs del sistema
  - bind9                # Servidor DNS
  - isc-dhcp-server      # Servidor DHCP (IPv4/IPv6)
  - fail2ban             # Protección contra ataques
  - ufw                  # Firewall

# almacenamiento/monitoreo
storage:
  disk_usage_warning: 80
  disk_usage_critical: 90
  inode_usage_warning: 85
  inode_usage_critical: 95
  watch_paths:
    - /var/log
    - /var
    - /tmp
    - /home
    - /boot
    - /etc
  journald_retention_days: 30
  syslog_retention_days: 14
  dhcp_log_retention_days: 7
  dns_log_retention_days: 14
  security_log_retention_days: 30

# Configuración de logging
logging:
  # Logs personalizados de aplicaciones
  custom_app_logs:
    - name: "proyecto-monitor"
      path: "/var/log/ansible/proyecto-monitor.log"
      frequency: "weekly"
      retain: 4
      mode: "0640"
      owner: "root"
      group: "adm"
    - name: "security-checks"
      path: "/var/log/security/security-checks.log"
      frequency: "daily"
      retain: 30
      mode: "0640"
      owner: "root"
      group: "adm"
      postrotate: "systemctl reload fail2ban"
  
  # Configuración de syslog
  syslog_server: "localhost"
  syslog_port: 514
  log_level: "info"
  
  # Alertas por email (opcional)
  email_alerts: false
  admin_email: "admin@{{ network_config.domain_name }}"
  
  # Configuración específica para particiones LVM
  lvm_monitoring: true
  critical_partitions:
    - "/"
    - "/var"
    - "/var/log"
    - "/tmp"
    - "/home"
    - "/boot"

# mantenimiento Windows programado
windows_maintenance:
  enable: true
  updates:
    day_of_week: Sunday
    time: '03:00'
  cleanup:
    day_of_week: Monday
    time: '04:00'
  antivirus:
    day_of_week: Wednesday
    time: '04:00'
  reboot:
    frequency: Daily
    time: '05:00'

# Configuración DNS
dns_domain_name: "{{ network_config.domain_name }}"
dns_network_ipv6: "2025:db8:10::/64"
dns_log_queries: true
dns_log_file: "/var/log/named/query.log"
dns_log_level: "info"
dns_forwarders:
  - "8.8.8.8"
  - "8.8.4.4"
  - "2001:4860:4860::8888"
  - "2001:4860:4860::8844"


# Registros DNS para la zona
dns_ipv6_gateway: "2025:db8:10::1"
dns_ipv6_reverse_zone: "0.1.0.8.b.d.5.2.0.2.ip6.arpa"

dns_records:
  # Servidor principal
  - name: "servidor"
    type: "AAAA"
    value: "2025:db8:10::2"
  
  # Alias para el servidor
  - name: "ns1"
    type: "AAAA"
    value: "2025:db8:10::2"
  
  - name: "dns"
    type: "AAAA"
    value: "2025:db8:10::2"
  
  # Servidor web
  - name: "web"
    type: "AAAA"
    value: "2025:db8:10::2"
  
  - name: "www"
    type: "CNAME"
    value: "servidor"
  
  # Servicios
  - name: "ftp"
    type: "CNAME"
    value: "servidor"
  
  - name: "nfs"
    type: "CNAME"
    value: "servidor"
  
  # ═══════════════════════════════════════════════════════════════
  # VMs - Los clientes se registrarán automáticamente por DDNS
  # ═══════════════════════════════════════════════════════════════
  # NO agregues registros estáticos aquí para VMs
  # DHCP + DDNS los agregará automáticamente cuando se conecten
  #
  # Ejemplo de cómo se verán después de conectarse:
  # - ubuntu-gaming.gamecenter.lan → 2025:db8:10::100 (asignado por DHCP)
  # - mi-pc.gamecenter.lan → 2025:db8:10::101 (asignado por DHCP)
