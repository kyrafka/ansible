---
# Configurar DDNS en DHCPv6

- name: "ğŸ” Verificar si existe clave DDNS"
  stat:
    path: /etc/bind/dhcp-key.key
  register: ddns_key_exists
  become: true

- name: "ğŸ”‘ Copiar clave DDNS para DHCP"
  copy:
    src: /etc/bind/dhcp-key.key
    dest: /etc/dhcp/dhcp-key.key
    owner: root
    group: root
    mode: '0640'
    remote_src: yes
  become: true
  when: ddns_key_exists.stat.exists

- name: "âœ… Clave DDNS configurada para DHCP"
  debug:
    msg: "â†’ DHCP puede actualizar DNS dinÃ¡micamente"
  when: ddns_key_exists.stat.exists

- name: "âš ï¸  Clave DDNS no encontrada"
  debug:
    msg: |
      â†’ La clave DDNS no existe en /etc/bind/dhcp-key.key
      â†’ DHCP funcionarÃ¡ sin actualizaciÃ³n dinÃ¡mica de DNS
      â†’ Para habilitar DDNS, ejecuta primero: bash scripts/run/run-dns.sh
  when: not ddns_key_exists.stat.exists
