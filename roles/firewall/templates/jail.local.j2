# Configuración personalizada de fail2ban para Proyecto SO
# Generado automáticamente por Ansible

[DEFAULT]
# Configuración global
bantime = 3600
findtime = 600
maxretry = 3
backend = auto
usedns = warn
logencoding = auto
enabled = false
mode = normal
filter = %(__name__)s[mode=%(mode)s]
allowipv6 = auto

# Configuración de acciones
destemail = root@localhost
sendername = Fail2Ban
mta = sendmail
protocol = tcp
chain = <known/chain>

# Acción por defecto
action = %(action_)s

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600

# Protección para Nginx
[nginx-http-auth]
enabled = true
port = http,https
filter = nginx-http-auth
logpath = /var/log/nginx/error.log
maxretry = 3
bantime = 3600

[nginx-badbots]
enabled = true
port = http,https
filter = nginx-badbots
logpath = /var/log/nginx/access.log
maxretry = 2
bantime = 7200

[nginx-noscript]
enabled = true
port = http,https
filter = nginx-noscript
logpath = /var/log/nginx/access.log
maxretry = 3
bantime = 3600

[nginx-limit-req]
enabled = true
port = http,https
filter = nginx-limit-req
logpath = /var/log/nginx/error.log
maxretry = 5
bantime = 1800

[proyecto-so-custom]
enabled = true
port = ssh,domain
filter = proyecto-so-custom
logpath = /var/log/auth.log
           /var/log/named/security.log
maxretry = 2
bantime = 7200