---
# InstalaciÃ³n de software gaming esencial

- name: "ğŸ“¦ Agregar repositorios necesarios"
  ansible.builtin.apt_repository:
    repo: "{{ item }}"
    state: present
    update_cache: no
  loop:
    - "ppa:lutris-team/lutris"
    - "ppa:graphics-drivers/ppa"
  become: true

- name: "ğŸ”„ Actualizar cachÃ© de paquetes"
  ansible.builtin.apt:
    update_cache: yes
  become: true

- name: "ğŸ® Instalar Steam"
  ansible.builtin.apt:
    name:
      - steam-installer
      - steam-devices
    state: present
  become: true

- name: "ğŸ•¹ï¸  Instalar Lutris"
  ansible.builtin.apt:
    name:
      - lutris
      - wine
      - winetricks
    state: present
  become: true

- name: "âš¡ Instalar GameMode"
  ansible.builtin.apt:
    name:
      - gamemode
      - libgamemode0
      - libgamemodeauto0
    state: present
  become: true

- name: "ğŸ“Š Instalar MangoHud"
  ansible.builtin.apt:
    name:
      - mangohud
    state: present
  become: true

- name: "ğŸ¯ Descargar Heroic Games Launcher"
  ansible.builtin.get_url:
    url: "https://github.com/Heroic-Games-Launcher/HeroicGamesLauncher/releases/latest/download/heroic_amd64.deb"
    dest: "/tmp/heroic.deb"
  become: true

- name: "ğŸ¯ Instalar Heroic Games Launcher"
  ansible.builtin.apt:
    deb: "/tmp/heroic.deb"
    state: present
  become: true

- name: "ğŸ’¬ Descargar Discord"
  ansible.builtin.get_url:
    url: "https://discord.com/api/download?platform=linux&format=deb"
    dest: "/tmp/discord.deb"
  become: true

- name: "ğŸ’¬ Instalar Discord"
  ansible.builtin.apt:
    deb: "/tmp/discord.deb"
    state: present
  become: true

- name: "ğŸ“¹ Instalar OBS Studio"
  ansible.builtin.apt:
    name:
      - obs-studio
      - ffmpeg
    state: present
  become: true

- name: "ğŸ”§ Instalar ProtonUp-Qt"
  ansible.builtin.shell: |
    pip3 install protonup-qt --break-system-packages
  become: true
  register: protonup_install
  failed_when: false
  changed_when: protonup_install.rc == 0

- name: "âœ… Software gaming instalado"
  ansible.builtin.debug:
    msg: "â†’ Steam, Lutris, Heroic, Discord, OBS y mÃ¡s instalados"
