---
# Configuración avanzada de seguridad adicional

- name: "Instalar herramientas de seguridad adicionales"
  apt:
    name:
      - lynis              # Auditoría de seguridad
      - rkhunter           # Detector de rootkits
      - chkrootkit         # Detector de rootkits alternativo
      - logwatch           # Análisis de logs
      - aide               # Detector de intrusiones
      - psad               # Análisis de logs de firewall
      - clamav             # Antivirus
      - clamav-daemon      # Daemon de ClamAV
      - unhide             # Detector de procesos ocultos
      - debsums            # Verificador de integridad de paquetes
    state: present
    update_cache: yes
  tags: security

- name: "Configurar Lynis (auditoría de seguridad)"
  include_tasks: configure_lynis.yml
  tags: [security, lynis]

- name: "Configurar RKHunter (detector de rootkits)"
  include_tasks: configure_rkhunter.yml
  tags: [security, rkhunter]

- name: "Configurar AIDE (detector de intrusiones)"
  include_tasks: configure_aide.yml
  tags: [security, aide]

- name: "Configurar Logwatch (análisis de logs)"
  include_tasks: configure_logwatch.yml
  tags: [security, logwatch]

- name: "Configurar ClamAV (antivirus)"
  include_tasks: configure_clamav.yml
  tags: [security, clamav]

- name: "Configurar PSAD (análisis de firewall)"
  include_tasks: configure_psad.yml
  tags: [security, psad]

- name: "Crear scripts de seguridad personalizados"
  include_tasks: create_security_scripts.yml
  tags: [security, scripts]

- name: "Configurar tareas programadas de seguridad"
  include_tasks: configure_security_cron.yml
  tags: [security, cron]