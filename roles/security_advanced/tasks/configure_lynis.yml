---
# Configuraci√≥n de Lynis - Auditor√≠a de seguridad

- name: "Crear directorio de configuraci√≥n de Lynis"
  file:
    path: /etc/lynis
    state: directory
    mode: '0755'

- name: "Configurar Lynis"
  template:
    src: lynis.conf.j2
    dest: /etc/lynis/default.prf
    mode: '0644'
  
- name: "Crear script de auditor√≠a autom√°tica"
  template:
    src: lynis-audit.sh.j2
    dest: /usr/local/bin/lynis-audit.sh
    mode: '0755'

- name: "Ejecutar auditor√≠a inicial de Lynis"
  command: lynis audit system --quick --quiet
  register: lynis_initial
  changed_when: false
  failed_when: false

- name: "Mostrar resumen de auditor√≠a inicial"
  debug:
    msg: |
      üîç Auditor√≠a inicial de Lynis completada
      Ejecuta 'lynis-audit.sh' para auditor√≠a completa
      Reportes en: /var/log/lynis.log