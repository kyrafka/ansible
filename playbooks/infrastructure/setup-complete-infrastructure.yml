---
# Playbook maestro para configurar toda la infraestructura
# Ejecutar: ansible-playbook -i inventory/hosts.ini setup-complete-infrastructure.yml -K

- name: "๐ CONFIGURACIรN COMPLETA DE INFRAESTRUCTURA IPv6"
  hosts: servers
  become: true
  gather_facts: true

  tasks:
    - name: "๐ Inicio de configuraciรณn"
      ansible.builtin.debug:
        msg:
          - "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
          - "๐ Configurando infraestructura completa"
          - "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
          - "Servidor: {{ inventory_hostname }}"
          - "IP: {{ ansible_host }}"
          - ""
          - "Se configurarรก:"
          - "  1. Red (IPv6, NAT64, radvd)"
          - "  2. DHCP IPv6"
          - "  3. DNS con BIND9 + DNS64"
          - "  4. Firewall"
          - "  5. Tayga NAT64"
          - "  6. Squid Proxy"
          - "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"

    - name: "๐ PASO 1: Configurar red"
      ansible.builtin.include_role:
        name: network
      tags: [network]

    - name: "๐ก PASO 2: Configurar DHCP IPv6"
      ansible.builtin.include_role:
        name: dhcpv6
      tags: [dhcp]

    - name: "๐ PASO 3: Configurar DNS + DNS64"
      ansible.builtin.include_role:
        name: dns_bind
      tags: [dns]

    - name: "๐ก๏ธ  PASO 4: Configurar Firewall"
      ansible.builtin.include_role:
        name: firewall
      tags: [firewall]

    - name: "โ Configuraciรณn del servidor completada"
      ansible.builtin.debug:
        msg:
          - "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
          - "โ Servidor configurado exitosamente"
          - "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
          - ""
          - "Servicios activos:"
          - "  โข Red IPv6: 2025:db8:10::/64"
          - "  โข DHCP IPv6: Rango 2025:db8:10::100-200"
          - "  โข DNS: 2025:db8:10::2 (con DNS64)"
          - "  โข NAT64: Tayga + Squid Proxy"
          - "  โข Firewall: Configurado"
          - ""
          - "Prรณximos pasos:"
          - "  1. Crear VMs con: ansible-playbook create-vm-ubuntu-desktop.yml"
          - "  2. Configurar VMs con: ansible-playbook configure-ubuntu-desktop.yml"
          - "  3. Instalar gaming con: ansible-playbook setup-gaming-desktop.yml"
          - ""
          - "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
